@model Books.Domain.Models.Paciente
@{
    ViewData["Title"] = "Editar paciente";
}

<div class="text-center">
    <h1 class="display-4">Editando un paciente</h1>
</div>
<div>
    <div class="row">
        <div class="col-md-12">
            <form id="editPacienteForm">
               <input type="hidden" id="BookId" value="@Model.ID"/>
                <div class="col-md-3">
                  <label > Nombre: </label>
                  <input id="FirstName" type="text" class="form-control" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3">
                    <label > Apellido: </label>
                    <input id="LastName" type="text" class="form-control" />
                    <span  class="text-danger"></span>
                </div>
                <div class="col-md-3">
                    <label > Sexo: </label>
                    <input id="Sex" type="text" class="form-control"  />
                    <span  class="text-danger"></span>
                </div>
                <div class="col-md-3">
                 <button type="button" class="btn btn-primary" 
                 onclick="updatePaciente()">Guardar</button>
                </div>
            </form>
          
        </div>
    </div>
</div>
@section Scripts {
    <script>
        $(document).ready(function () {
            let ID = $('#ID').val();
            loadPaciente(ID);
        });

        function loadPaciente(ID) {
            $.ajax({
                url: `https://localhost:7034/api/Pacientes/${ID}`,
                type: 'GET',
                success: function (paciente) {
                    $('#FirstName').val(paciente.FirstName);
                    $('#LastName').val(paciente.LastName);
                    $('#Sex').val(paciente.Sex);
                },
                error: function (error) {
                    console.log(error);
                    alert('Ocurrió un error al cargar los datos del paciente');
                }
            });
        }

        function updatePaciente() {
            let ID = $('#ID').val();
            let paciente = {
                "ID": ID,
                "FirstName": $('#FirstName').val(),
                "LastName": $('#LastName').val(),
                "Sex": $('#Sex').val()
            };

            $.ajax({
                url: `https://localhost:7034/api/Pacientes/${ID}`,
                type: 'PUT',
                contentType: 'application/json',
                data: JSON.stringify(pacientes),
                success: function (result) {
                    window.location.href = '/Pacientes/Index';
                },
                error: function (error) {
                    console.log(error);
                    alert('Ocurrió un error');
                }
            });
        }
    </script>
}